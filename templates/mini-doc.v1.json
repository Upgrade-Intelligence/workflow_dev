{
  "template_id": "mini-doc",
  "version": "1.0",
  "display": {
    "title": "Mini Documentary",
    "one_liner": "Short documentary-style explainer with scenes and narration.",
    "example_use_cases": [
      "Coral reefs mini-doc",
      "Clean energy overview",
      "Historical invention profile"
    ]
  },
  "tags": ["education", "docu", "explainer", "science"],
  "inputs": {
    "required": ["theme"],
    "optional": [
      "parental_guidance",
      "character_preferences",
      "plot_preferences",
      "language",
      "narrator_voice",
      "reading_level",
      "tone",
      "illustration_style",
      "custom_instructions"
    ]
  },
  "input_specs": [
    {"key": "custom_instructions", "label": "Custom Instructions", "type": "string", "default": ""}
  ],
  "constants": {
    "word_band": {"min_words": 380, "max_words": 420},
    "pagination": {"node_count": 10, "desired_choice_count": 3},
    "media": {"style_guidance_ref": "@mini-doc.image_style_guidance.json"}
  },
  "stages": {
    "stage1": {
      "system": "You are the Educational Theme Integrator for an interactive storybook generator serving children aged 3-5. Work only with the information provided.",
      "instructions": "Produce a learning blueprint focused on factual accuracy and age-appropriate framing. If custom instructions are present, respect them when safe and appropriate. Include learning_objectives, target_skills, and theme_alignment_notes for documentary tone.",
      "input_mapping": {
        "child_age": "{{inputs.child_age}}",
        "theme": "{{inputs.theme}}",
        "parental_guidance": "{{inputs.parental_guidance}}",
        "character_preferences": "{{inputs.character_preferences}}",
        "plot_preferences": "{{inputs.plot_preferences}}",
        "custom_instructions": "{{inputs.custom_instructions}}"
      }
    },
    "stage2": {
      "system": "You are the Story Generator for an interactive children’s story (ages 3-5). Use only the supplied context.",
      "instructions": "Write a cohesive mini-doc narrative between {{constants.word_band.min_words}} and {{constants.word_band.max_words}} words with a scene-like flow: hook, 3–5 scenes, insight, conclusion. Respect any safe custom instructions provided. Provide character_bible for narrator/guide and settings. Use {{inputs.language}} if provided, tone {{inputs.tone}} if provided, and reading simplicity per {{inputs.reading_level}} if provided.",
      "input_mapping": {
        "learning_framework_json": "{{stage1.output}}",
        "child_age": "{{inputs.child_age}}",
        "theme": "{{inputs.theme}}",
        "parental_guidance": "{{inputs.parental_guidance}}",
        "character_preferences": "{{inputs.character_preferences}}",
        "plot_preferences": "{{inputs.plot_preferences}}",
        "custom_instructions": "{{inputs.custom_instructions}}"
      }
    },
    "stage3": {
      "system": "You orchestrate story pagination and interactive branches for a preschool storybook.",
      "instructions": "Split into nodes and add viewer polls/choices per Stage 3 rules; maintain chronology and factual consistency.",
      "input_mapping": {
        "story_draft_json": "{{stage2.output}}",
        "learning_framework_json": "{{stage1.output}}",
        "node_count": "{{constants.pagination.node_count}}",
        "desired_choice_count": "{{constants.pagination.desired_choice_count}}"
      }
    },
    "stage4": {
      "system": "You convert Stage 4 story nodes into display-ready scene text and matching image prompts.",
      "instructions": "Convert to SceneText and ImagePrompt with documentary visual cues; polish choices. Follow Stage 4 rules. Append style_prompt_suffix from constants.media.style_guidance_ref (if present) to each ImagePrompt.",
      "input_mapping": {
        "story_node_graph_xml": "{{stage3.output}}",
        "character_bible_json": "{{stage2.output.character_bible}}",
        "style_defaults": "{\"illustration_style\": \"{{inputs.illustration_style}}\", \"narrator_voice\": \"{{inputs.narrator_voice}}\"}"
      }
    }
  },
  "safety": {"age_appropriate": true, "notes": "Factual, non-sensational; no PII."},
  "outputs": {"expects": ["LearningBlueprint", "StoryDraft", "StoryNodes", "Storyboard"], "format": "JSON"},
  "lookup": {"reading_level_sentence_length": {"A1": 16, "B1": 20}}
}
